<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Smart Tourist Safety - MCPT System</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    <!-- Navigation Bar -->
    <nav class="navbar">
        <div class="nav-content">
            <h1 class="nav-title">
                <span class="icon">üé•</span>
                Smart Tourist Safety System
                <span class="subtitle">Multi-Camera People Tracking</span>
            </h1>
            <div class="nav-status">
                <span id="statusBadge" class="badge badge-stopped">‚óè STOPPED</span>
            </div>
        </div>
    </nav>

    <!-- Main Container -->
    <div class="container">
        <!-- Control Panel -->
        <div class="control-panel card">
            <h2 class="card-title">‚öôÔ∏è Control Panel</h2>
            
            <div class="form-group">
                <label for="videoSource">Video Source</label>
                <select id="videoSource" class="input-select">
                    <option value="webcam">üì∑ Webcam (Default Camera)</option>
                    <option value="video">üé¨ Video File (MP4)</option>
                    <option value="esp32cam">üì° ESP32-CAM (URL)</option>
                </select>
            </div>

            <div class="form-group" id="videoPathGroup" style="display: none;">
                <label for="videoPath">Video File Path</label>
                <input type="text" id="videoPath" class="input-text" 
                       placeholder="videos/sample.mp4" value="videos/sample.mp4">
            </div>

            <div class="form-group" id="esp32UrlGroup" style="display: none;">
                <label for="esp32Url">ESP32-CAM Stream URL</label>
                <input type="text" id="esp32Url" class="input-text" 
                       placeholder="http://192.168.1.100:81/stream">
            </div>

            <div class="button-group">
                <button class="btn btn-primary" onclick="startDetection()">
                    <span class="btn-icon">‚ñ∂Ô∏è</span> Start Detection
                </button>
                <button class="btn btn-danger" onclick="stopDetection()">
                    <span class="btn-icon">‚èπÔ∏è</span> Stop Detection
                </button>
            </div>
        </div>

        <!-- Main Grid -->
        <div class="main-grid">
            <!-- Video Feed -->
            <div class="video-section">
                <div class="card">
                    <h2 class="card-title">üìπ Live Camera Feed</h2>
                    <div class="video-container">
                        <img id="videoFeed" src="" alt="Video Feed" class="video-feed">
                        <div id="noVideoPlaceholder" class="no-video">
                            <div class="placeholder-content">
                                <span class="placeholder-icon">üìπ</span>
                                <p>No video feed active</p>
                                <p class="placeholder-hint">Click "Start Detection" to begin</p>
                            </div>
                        </div>
                        <div id="recordingIndicator" class="recording-indicator" style="display: none;">
                            <span class="pulse-dot"></span> DETECTING
                        </div>
                    </div>
                </div>
            </div>

            <!-- Stats & Detections -->
            <div class="sidebar">
                <!-- Real-time Stats -->
                <div class="card">
                    <h2 class="card-title">üìä Real-Time Statistics</h2>
                    <div class="stats-grid">
                        <div class="stat-box stat-primary">
                            <div class="stat-icon">‚ö°</div>
                            <div class="stat-content">
                                <div class="stat-label">FPS</div>
                                <div class="stat-value" id="fpsValue">0</div>
                            </div>
                        </div>
                        <div class="stat-box stat-success">
                            <div class="stat-icon">üë•</div>
                            <div class="stat-content">
                                <div class="stat-label">Persons</div>
                                <div class="stat-value" id="personsValue">0</div>
                            </div>
                        </div>
                    </div>

                    <div class="info-section">
                        <div class="info-item">
                            <span class="info-label">AI Device:</span>
                            <span id="deviceInfo" class="info-value">Loading...</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">Model:</span>
                            <span class="info-value">YOLOv8x</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">Status:</span>
                            <span id="systemStatus" class="info-value">Ready</span>
                        </div>
                    </div>
                </div>

                <!-- Detection List -->
                <div class="card detections-card">
                    <h2 class="card-title">üéØ Active Detections</h2>
                    <div id="detectionsList" class="detections-list">
                        <div class="empty-state">
                            <span class="empty-icon">üì≠</span>
                            <p>No detections yet</p>
                            <p class="empty-hint">Start detection to see results</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <p>Smart Tourist Safety System | SIH 2025 | Multi-Camera People Tracking Demo</p>
    </footer>

    <!-- Socket.IO -->
    <script src="https://cdn.socket.io/4.5.4/socket.io.min.js"></script>
    <script src="{{ url_for('static', filename='js/dashboard.js') }}"></script>
</body>
</html>
